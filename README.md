# PDF 문서 추출기

> **개요**: PDF 문서의 텍스트를 문장 단위로 추출하기 위함   
> **데이터 종류**: 논문, 도서 형식   
> **사용 라이브러리**
> - **PyMuPDF(fitz)**: PDF 문서에서 텍스트를 추출
> - **re**: 정규 표현식을 이용한 텍스트 필터링 및 정제
> - **os**: 파일 및 폴더 경로 조작
> - **csv**: 추출 데이터를 CSV 형식으로 저장
> - **logging**: 프로그램 실행 및 오류 로깅
> - **warnings**: 불필요한 경고 메시지 억제
> - **tqdm**: 프로그램 진행률 시각화 도구
---

## 🔍주요 로직 및 설명

### 1. PDF 파일 열기 및 예외 처리
   - `process_pdf_folder()` 함수에서 지정된 폴더의 PDF 파일을 순차적으로 처리합니다.</br> 
   - 각 파일을 `fitz` 라이브러리를 사용하여 열고, 파일이 손상되었거나 열기 실패 시 사용자 정의 예외(`PDFProcessingError`)를 발생시켜 로그에 기록합니다. </br>
   <sub>대량의 PDF 문서를 처리할 때 오류로 인한 무한 루프를 방지하기 위해, 예외 발생 시 해당 파일을 건너뛰고 다음 파일로 진행</sub>

### 2. 텍스트 추출 및 정제
   - `safe_get_text()` 함수는 PDF 페이지의 텍스트를 안전하게 추출하며, flags = 2 인자를 통해 두 개의 글자가 하나로 인식되어 사라지는 문제를 해결합니다. 
   - `clean_text()`에서는 불필요한 공백, 줄 바꿈, tab 등을 정제하며 `remove_unnecessary_elements()` 함수에서는 문장 속 섞여 있는 이미지, 표, 수식, 특수 기호 등을 정제합니다. </br>
   <sub>패턴 적용 시 더 구체적인 조건을 먼저 검증하면 효과적으로 적용할 수 있음</sub>

### 3. 문장 분리 및 최소 길이 필터링
   - `split_into_sentences()` 함수는 추출된 텍스트를 문장 단위로 분리하며, (마침표, 줄 바꿈, 콜론) + 공백을 기준으로 문장을 나눕니다. 또한 약어 및 특수 패턴을 정의하여 임시 마커로 치환하는 과정을 통해 문장을 최대한 잘 분리하도록 구현하였습니다. 
   - 각 문장은 지정된 최소 길이(`min_length`) 기준으로 필터링되어, 유의미한 정보만 추출되도록 설계되었습니다.</br>
   <sub>마침표, 줄 바꿈, 콜론으로 문장 분리 시 문장 중간에 끊기는 경우가 많음. 따라서 성능 개선을 위해 뒤에 공백을 기준으로 분리</sub>
   
### 4. 유효성 검사 및 문서 제외
   - `check_document_validity()` 함수는 빈 문서인지 확인하고 특수문자의 비율 등을 검사하여 불필요한 파일을 제외합니다.
   - 유효하지 않은 문서는 `write_excluded_doc()` 함수에 의해 제외 사유와 함께 CSV 파일에 기록됩니다.

### 5. 데이터 저장
   - `process_pdf()` 함수는 문서에서 추출된 문장을 `csv_writer`로 출력하며, 각 문장에 대해 `doc_id`, `type`, `page_no`, `sentence_no` 등의 메타데이터를 기록합니다.
   - 유효하지 않은 문서나 오류가 발생한 문서는 `excluded_writer`를 통해 별도로 기록하여 문서 처리 통계를 제공합니다.

### 6. 로깅 및 예외 처리
   - `logging`을 통해 주요 작업과 오류가 기록되며, 문제 발생 시 디버깅과 유지 보수가 용이하도록 설계되었습니다.
   - `tqdm`을 통해 불필요한 작업 과정이 너무 많이 출력 되는 문제를 개선하여 프로그램의 진행률을 시각화 하였습니다. 
   - 예외 발생 시 사용자에게 오류 내용을 알리고, 프로그램이 종료되지 않고 계속해서 다른 파일을 처리할 수 있도록 보장합니다.

---
## ▶️실행 방법
### 1. 라이브러리 설치
> - **PyMuPDF**
> - **regex**
### 2. 폴더 경로 설정
   - 추출할 pdf 문서가 있는 폴더의 경로와 결과 csv를 저장할 경로를 설정

### 3. 실행
